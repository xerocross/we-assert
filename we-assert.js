!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("WeAssert",[],n):"object"==typeof exports?exports.WeAssert=n():t.WeAssert=n()}(this,function(){return function(t){var n={};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)r.d(e,i,function(n){return t[n]}.bind(null,i));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="/",r(r.s=1)}([function(t,n,r){"use strict";const e=r(4),i=r(5);function o(t){return t&&"substitution"!=t.action&&"literal"!=t.action?null==t.action?o(t.args[0]):{action:t.action,args:t.args.map(o)}:t}Array.prototype.peek=function(){return this[this.length-1]},Array.prototype.includes||(Array.prototype.includes=function(t){var n=Object(this),r=parseInt(n.length)||0;if(0===r)return!1;var e,i,o=parseInt(arguments[1])||0;for(o>=0?e=o:(e=r+o)<0&&(e=0);e<r;){if(t===(i=n[e])||t!=t&&i!=i)return!0;e++}return!1}),String.prototype.startsWith||(String.prototype.startsWith=function(t,n){return n=n||0,this.indexOf(t,n)===n}),t.exports.negate=function(t){return{action:"negation",args:[t]}},t.exports.treeToExpr=function t(n){if("substitution"==n.action)return n.args[0];if("literal"==n.action)return n.args[0];if("negation"==n.action)return"substitution"==n.args[0].action?"!"+n.args[0].args[0]:"(!"+t(n.args[0])+")";if("conjunction"==n.action)return"("+t(n.args[0])+" & "+t(n.args[1])+")";if("disjunction"==n.action)return"("+t(n.args[0])+" | "+t(n.args[1])+")";if("implication"==n.action)return"("+t(n.args[0])+" -> "+t(n.args[1])+")";if("equivalence"==n.action)return"("+t(n.args[0])+" <-> "+t(n.args[1])+")";return""},t.exports.proofToString=function(t){return(t=t.map(function(t){return"sep"==t.label?"------------------------------\n":t.tree?t.idx+"\t"+t.tree+"\t"+t.label+"\n":t.label+"\n"})).join("")},t.exports.buildTree=function(t){return o(e.parse(i.lex(t)))}},function(t,n,r){"use strict";n.__esModule=!0;var e=r(2),i=function(){},o={0:"DEBUG",1:"WARN",2:"ERROR"},a=function(t){switch(t){case"DEBUG":return 0;case"WARN":return 1;case"ERROR":return 2}throw new Error};n.default={checkVulcan:function(){return e},build:function(){var t=2,n={},r={},u=[],s={define:{type:function(t,n){r[t]=n}},assume:function(t){u.push(t)},setLevel:function(n){var r=a(n);if(0!=r&&1!=r&&2!=r)throw new Error("we-assert: invalid error level");t=r},getLevel:function(){return o[t]},checkIsProved:function(t){var n=e.prove(u,t);return e.isProofComplete(n)},setHandler:function(t){i=t},getProposition:function(t){return n[t]},defineProposition:function(t,r){n[t]=r},assert:{that:function(t,n){return t||i(n),1==t},proposition:function(t,n){s.defineProposition(t,n);var r=n[0],e=n[1],i=n[2],o=r.apply(void 0,e);return o&&u.push(t),this.that(o,i)},thatIsProved:function(t,n){var r=s.checkIsProved(t);return r||i(n),r},forXBetween:function(t,n){var r=this.that;return{that:function(e,i){for(var o=t;o<n;o++)r(e(o),i)}}},atLevel:function(n){var r=this.that;return{that:function(e,i){a(n)>=t&&r(e,i)}}}}};return s}}},function(t,n,r){"use strict";const e=r(3),i=r(0);function o(t){let n=[],r=function(t){t&&("negation"!=t.action||"substitution"!=t.args[0].action?"substitution"!=t.action?(r(t.args[0]),r(t.args[1])):n.push(t.args[0]):n.push("!"+t.args[0].args[0]))};return r(t),n}function a(t,n){let r=o(t),e=o(n),a=function(t,n){let r=[];return t.forEach(function(t){let e=t.startsWith("!")?t.substring(1):t,i=t.startsWith("!")?t.substring(1):"!"+t;n.includes(i)&&r.push(e)}),r}(r,e);if(a.length>1)return{action:"literal",args:[!0]};let u=r.concat(e);return u.sort(),0==(u=u.filter(function(t){let n=t.startsWith("!")?t.substring(1):t;return!a.includes(n)}).reduce(function(t,n){return t.peek()==n?t:t.concat([n])},[])).length?{action:"literal",args:[!1]}:i.buildTree(u.join(" | "))}t.exports.prove=function(t,n){let r=[],o=[],u=0;t.forEach(function(t){let n=e.convertToCNF(i.buildTree(t)).map(function(t){return t.idx=u++,t});o=o.concat(n),r.push(o)});let s=u,c=r.map(function(t){let n=t.peek();return n}).map(function(t){let n=e.splitClauses(t.tree).map(function(n){return n.idx=u++,n.from=t.idx,n});return n}).reduce(function(t,n){return t.concat(n)},[]);c.forEach(function(t){o.push({label:"knowledge base clause from "+t.from,tree:t,idx:t.idx})});let f=e.convertToCNF(i.negate(i.buildTree(n)));f.peek().tree;e.splitClauses(f.peek().tree).forEach(function(t){t.idx=u++,c.push(t),o.push({label:"assume for a contradiction",tree:c.peek(),idx:c.peek().idx})});let l=function(t){let n=[t],r=o.filter(function(n){return n.idx==t})[0];return r.req?(r.req.forEach(function(t){n=n.concat(l(t))}),n):n};for(;;){let t=[];for(let n=0;n<c.length;n++)for(let r=1;r<c.length;r++){let e=a(c[n],c[r]);if(!t.map(i.treeToExpr).includes(i.treeToExpr(e))){if(e.idx=u++,o.push({label:"resolve of "+c[n].idx+" and "+c[r].idx,tree:e,idx:e.idx,req:[c[n].idx,c[r].idx]}),"literal"==e.action&&0==e.args[0]){let t=l(e.idx);return o.filter(function(n){return t.includes(n.idx)||n.idx<=s||"sep"==n.label}).map(function(t){return t.tree&&(t.tree=i.treeToExpr(t.tree)),t})}"literal"==e.action&&1==e.args[0]||t.push(e)}}let n=c.map(i.treeToExpr),r=t.map(i.treeToExpr).every(function(t){return n.includes(t)});if(r)return o.push({label:"model exhausted, proof could not be reached"}),o.map(function(t){return t.tree&&(t.tree=i.treeToExpr(t.tree)),t});c=c.concat(t)}},t.exports.addParens=function(t){return i.treeToExpr(i.buildTree(t))},t.exports.isProofComplete=function(t){return"model exhausted, proof could not be reached"!=t.peek().label}},function(t,n,r){"use strict";const e=r(0);function i(t,n){return{action:"conjunction",args:[t,n]}}function o(t,n){return{action:"implication",args:[t,n]}}function a(t){return{action:"negation",args:[t]}}function u(t,n){return{action:"disjunction",args:[t,n]}}function s(t){return t&&"substitution"!=t.action&&"literal"!=t.action?"equivalence"==t.action?i(o(s(t.args[0]),s(t.args[1])),o(s(t.args[1]),s(t.args[0]))):{action:t.action,args:t.args.map(s)}:t}function c(t){if(!t||"substitution"==t.action||"literal"==t.action)return t;if("negation"==t.action){if("disjunction"==t.args[0].action)return c(i(a(t.args[0].args[0]),a(t.args[0].args[1])));if("conjunction"==t.args[0].action)return c(u(a(t.args[0].args[0]),a(t.args[0].args[1])))}return{action:t.action,args:t.args.map(c)}}function f(t){return t&&"substitution"!=t.action&&"literal"!=t.action?"implication"==t.action?u(a(f(t.args[0])),f(t.args[1])):{action:t.action,args:t.args.map(f)}:t}function l(t){return t&&"substitution"!=t.action&&"literal"!=t.action?"negation"==t.action&&"negation"==t.args[0].action?l(t.args[0].args[0]):{action:t.action,args:t.args.map(l)}:t}function g(t){return JSON.parse(JSON.stringify(t))}function p(t){if(!t||"substitution"==t.action||"literal"==t.action)return t;if("disjunction"==t.action){if("conjunction"==t.args[1].action)return p(i(u(g(t.args[0]),g(t.args[1].args[0])),u(g(t.args[0]),g(t.args[1].args[1]))));if("conjunction"==t.args[0].action)return p(i(u(g(t.args[1]),g(t.args[0].args[0])),u(g(t.args[1]),g(t.args[0].args[1]))))}return{action:t.action,args:t.args.map(p)}}function d(t){if(!t||"substitution"==t.action||"literal"==t.action)return t;if("disjunction"==t.action){var n=t.args[0],r=t.args[1];if("negation"==n.action&&e.treeToExpr(n.args[0])==e.treeToExpr(r))return{action:"literal",args:[!0]};if("negation"==r.action&&e.treeToExpr(r.args[0])==e.treeToExpr(n))return{action:"literal",args:[!0]}}if("conjunction"==t.action){n=t.args[0],r=t.args[1];if("negation"==n.args[0].action&&e.treeToExpr(n.args[0].args[0])==e.treeToExpr(r))return{action:"literal",args:[!1]};if("negation"==r.args[0].action&&e.treeToExpr(r.args[0].args[0])==e.treeToExpr(n))return{action:"literal",args:[!1]}}return{action:t.action,args:t.args.map(d)}}function b(t){if(!t||"substitution"==t.action||"literal"==t.action)return t;if("disjunction"==t.action){var n=t.args[0],r=t.args[1];if("literal"==n.action){if(1==n.args[0])return n;if(0==n.args[0])return r}if("literal"==r.action){if(1==r.args[0])return r;if(0==r.args[0])return n}}if("conjunction"==t.action){n=t.args[0],r=t.args[1];if("literal"==n.action){if(1==n.args[0])return r;if(0==n.args[0])return n}if("literal"==r.action){if(1==r.args[0])return n;if(0==r.args[0])return r}}return{action:t.action,args:t.args.map(b)}}function h(t){var n=function(t){return!(t.args.length<2)&&("implication"!=t.action&&"equivalence"!=t.action&&"disjunction"!=t.action&&(e="conjunction"==t.args[0].action?n(t.args[0]):r(t.args[0]),"conjunction"==t.args[1].action?n(t.args[1])&&e:r(t.args[1])&&e));var e},r=function(t){return!!t&&("substitution"==t.action||"literal"==t.action||"conjunction"!=t.action&&("negation"==t.action?"substitution"==t.args[0].action:"disjunction"==t.action&&r(t.args[0]&&t.args[1])))};return"substitution"==t.action||"negation"==t.action&&"substitution"==t.args[0].action||n(t)}t.exports.convertToCNF=function(t){var n=[{task:"eliminate bijection",f:s},{task:"eliminate implication",f:f},{task:"DeMorgan's",f:c},{task:"eliminate double negation",f:l},{task:"distribute or over and",f:p},{task:"complementation",f:d},{task:"identity",f:b}],r=[{label:"initial expression",tree:t}];for(let t of n){if(h(r.peek().tree))break;for(;;){var i=t.f(r.peek().tree);if(e.treeToExpr(i)==e.treeToExpr(r.peek().tree))break;r.push({label:t.task,tree:i})}}return r},t.exports.isCNF=h,t.exports.splitClauses=function(t){var n=[],r=function(t){if("conjunction"==t.action)return r(t.args[0]),void r(t.args[1]);n.push(t)};return r(t),n}},function(t,n){t.exports.parse=function(t){var n;return function i(o){o=o||null;var a=[];for(;n=t.shift();)if("boundary"==n.type){if("("==n.value)a.push(i());else if(")"==n.value)return r(o,a)}else if("variable"==n.type){if(a.push(r("substitution",[n.value])),e(o))return r(o,a)}else if("operator"==n.type){if(e(n.value)){a.push(i(n.value));continue}if(o){var u=a.slice(0);(a=[]).push(r(o,u))}o=n.value}return r(o,a)}();function r(t,n){return{action:(r=t,{"!":"negation","|":"disjunction","&":"conjunction","->":"implication","<->":"equivalence"},{"!":"negation","|":"disjunction","&":"conjunction","->":"implication","<->":"equivalence"}[r]||r),args:n};var r}function e(t){return"!"===t}}},function(t,n){t.exports.lex=function(t){var n,r=0,e=[],i="";for(;n=t[r++];)if(s(n))-1!==["!","|","&","->","<->"].indexOf(i+=n)&&(o("operator",i),i="");else{if(i.length&&f(i,r-i.length-1),a(n))continue;u(n)?o("variable",n.toUpperCase()):c(n)?o("boundary",n):f(n,r-2)}return e;function o(t,n){e.push({type:t,value:n})}function a(t){return/\s/.test(t)}function u(t){return/[A-Za-z]/.test(t)}function s(t){return/[<>\-|&!]/.test(t)}function c(t){return/[\(\)]/.test(t)}function f(t,n){throw new Error('Unrecognized token "'+t+'" on position '+n+"!")}}}])});